SELECT     TOP (100) PERCENT PROD_CD, CASE WHS_NUM WHEN ('30') THEN SUM(IN_STOCK) - (SUM(BACK_QTY) + SUM(ORDER_QTY)) END AS AVAIL_01,
                      CASE WHS_NUM WHEN ('81') THEN SUM(IN_STOCK) - (SUM(BACK_QTY) + SUM(ORDER_QTY)) END AS AVAIL_05,
                      CASE WHS_NUM WHEN ('07') THEN SUM(IN_STOCK) - (SUM(BACK_QTY) + SUM(ORDER_QTY)) END AS AVAIL_07,
                      CASE WHS_NUM WHEN ('20') THEN SUM(IN_STOCK)  - (SUM(BACK_QTY) + SUM(ORDER_QTY)) END AS AVAIL_20,
                      CASE WHS_NUM WHEN ('30') THEN SUM(IN_STOCK) END AS INSTK_01,
                      CASE WHS_NUM WHEN ('81') THEN SUM(IN_STOCK) END AS INSTK_05,
                      CASE WHS_NUM WHEN ('07') THEN SUM(IN_STOCK) END AS INSTK_07,
                      CASE WHS_NUM WHEN ('20') THEN SUM(IN_STOCK) END AS INSTK_20,
                      CASE WHS_NUM WHEN ('30') THEN SUM(ON_ORDER_QTY) END AS PO_01,
                      CASE WHS_NUM WHEN ('81') THEN SUM(ON_ORDER_QTY) END AS PO_05,
                      CASE WHS_NUM WHEN ('07') THEN SUM(ON_ORDER_QTY) END AS PO_07,
                      CASE WHS_NUM WHEN ('20') THEN SUM(ON_ORDER_QTY) END AS PO_20,
                      CASE WHS_NUM WHEN ('30') THEN SUM(WATER_QTY) END AS OTW_01,
                      CASE WHS_NUM WHEN ('81') THEN SUM(WATER_QTY) END AS OTW_05,
                      CASE WHS_NUM WHEN ('07') THEN SUM(WATER_QTY) END AS OTW_07,
                      CASE WHS_NUM WHEN ('20') THEN SUM(WATER_QTY) END AS OTW_20,
                      CASE WHS_NUM WHEN ('30') THEN SUM(ORDER_QTY) END AS ORD_01,
                      CASE WHS_NUM WHEN ('81') THEN SUM(ORDER_QTY) END AS ORD_05,
                      CASE WHS_NUM WHEN ('07') THEN SUM(ORDER_QTY) END AS ORD_07,
                      CASE WHS_NUM WHEN ('20') THEN SUM(ORDER_QTY) END AS ORD_20
FROM         omsdata2.dbo.inv_data
GROUP BY PROD_CD, WHS_NUM
ORDER BY PROD_CD, WHS_NUM
